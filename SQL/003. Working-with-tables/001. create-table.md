# Создание таблиц: оператор CREATE TABLE

Оператор `CREATE TABLE` используется для создания новой таблицы в базе данных. С его помощью определяются имя таблицы, столбцы и их типы данных. Также можно указать ограничения, такие как первичные и внешние ключи.

## Структура команды CREATE TABLE

1. **Имя таблицы** — указывается имя создаваемой таблицы.
2. **Столбцы** — для каждого столбца указывается имя и тип данных.
3. **Ограничения** — например, первичные и внешние ключи, уникальные и проверочные ограничения.

### Советы:
- Придерживайтесь осмысленных имен для таблиц и столбцов, чтобы код был читаемым.
- Избегайте создания избыточных таблиц. Если данные могут быть объединены в одну таблицу, рассмотрите возможность нормализации.

## Типы данных

1. **Целые числа**: используйте для чисел без десятичных знаков. Поддерживаемые типы: `INT`, `BIGINT`, `SMALLINT` и т. д.
2. **Числа с плавающей запятой**: используйте для чисел с десятичными знаками. Поддерживаемые типы: `FLOAT`, `DOUBLE`, `DECIMAL`.
3. **Строки**: используются для хранения текстовых данных. Поддерживаемые типы: `VARCHAR`, `CHAR`, `TEXT`.
4. **Даты и время**: используйте для хранения дат и времени. Поддерживаемые типы: `DATE`, `TIME`, `DATETIME`, `TIMESTAMP`.
5. **Логические значения**: для хранения булевых значений (истина/ложь). Тип данных: `BOOLEAN`.

### Советы:
- Используйте тип данных, соответствующий значению, чтобы минимизировать использование памяти.
- Использование строковых типов с ограниченной длиной (`CHAR`, `VARCHAR`) важно для обеспечения оптимальной производительности.

## Первичные и внешние ключи

### Первичный ключ (`PRIMARY KEY`):
- Это столбец или группа столбцов, значения которых уникальны для каждой строки. Он гарантирует, что каждая запись в таблице будет уникальной.
- Первичный ключ автоматически создает индекс, что ускоряет поиск по этому столбцу.

### Внешний ключ (`FOREIGN KEY`):
- Это столбец, который ссылается на первичный ключ другой таблицы, обеспечивая связь между таблицами.
- Внешний ключ помогает поддерживать целостность данных, предотвращая удаление или изменение записей, которые ссылаются на другие записи.

### Советы:
- Используйте первичный ключ для гарантии уникальности записей в таблице.
- Внешние ключи обеспечивают связность данных, но могут снижать производительность при большом объеме операций обновления и удаления.

## Универсальный пример кода с CREATE TABLE

```sql
CREATE TABLE employees (
    employee_id INT PRIMARY KEY,              -- Уникальный идентификатор сотрудника
    first_name VARCHAR(50) NOT NULL,          -- Имя сотрудника
    last_name VARCHAR(50) NOT NULL,           -- Фамилия сотрудника
    email VARCHAR(100) UNIQUE NOT NULL,       -- Электронная почта, должна быть уникальной
    hire_date DATE NOT NULL,                  -- Дата найма
    salary DECIMAL(10, 2),                    -- Зарплата
    department_id INT,                        -- Идентификатор отдела
    manager_id INT,                           -- Идентификатор менеджера
    FOREIGN KEY (department_id) REFERENCES departments(department_id),  -- Внешний ключ на таблицу departments
    FOREIGN KEY (manager_id) REFERENCES employees(employee_id)         -- Внешний ключ на таблицу employees (само-ссылка)
);

## Комментарий к примеру CREATE TABLE

- `employee_id` — первичный ключ, уникальный для каждого сотрудника.
- `first_name`, `last_name`, `email` — обязательные поля с ограничением `NOT NULL`.
- `salary` — хранит зарплату с точностью до двух знаков после запятой.
- `department_id` — внешний ключ, ссылающийся на таблицу `departments`, которая хранит информацию об отделах.
- `manager_id` — внешний ключ, ссылающийся на таблицу `employees`, создавая связь между менеджером и подчинённым сотрудником (само-ссылка).


## Примеры создания таблиц с различными типами данных и ключами

### Пример 1: Базовая таблица пользователей

| Столбец       | Тип данных   | Описание                                   |
|---------------|--------------|--------------------------------------------|
| user_id       | INT          | Уникальный идентификатор пользователя (первичный ключ) |
| first_name    | VARCHAR(50)  | Имя пользователя                          |
| last_name     | VARCHAR(50)  | Фамилия пользователя                      |
| email         | VARCHAR(100) | Электронная почта                         |
| birth_date    | DATE         | Дата рождения                             |
| is_active     | BOOLEAN      | Статус активности пользователя (истина/ложь) |

**Комментарий**: В данном примере `user_id` — это первичный ключ, который уникален для каждого пользователя. Столбец `is_active` используется для определения активности пользователя.

### Пример 2: Таблица заказов с внешним ключом

| Столбец       | Тип данных   | Описание                                   |
|---------------|--------------|--------------------------------------------|
| order_id      | INT          | Уникальный идентификатор заказа (первичный ключ) |
| user_id       | INT          | Идентификатор пользователя, сделавшего заказ (внешний ключ) |
| order_date    | DATETIME     | Дата и время заказа                       |
| total_amount  | DECIMAL(10,2)| Общая сумма заказа                        |
| status        | VARCHAR(20)  | Статус заказа (например, "в процессе", "завершен") |

**Комментарий**: В этом примере внешний ключ `user_id` ссылается на `user_id` в таблице пользователей. Он гарантирует, что заказ может быть связан только с существующим пользователем.

### Пример 3: Таблица продуктов

| Столбец       | Тип данных   | Описание                                   |
|---------------|--------------|--------------------------------------------|
| product_id    | INT          | Уникальный идентификатор продукта (первичный ключ) |
| name          | VARCHAR(100) | Название продукта                         |
| price         | DECIMAL(10,2)| Цена продукта                             |
| stock_quantity| INT          | Количество на складе                      |
| is_discounted | BOOLEAN      | Наличие скидки на продукт (истина/ложь)   |

**Комментарий**: Таблица содержит информацию о продуктах. Столбец `is_discounted` помогает отслеживать, распространяется ли скидка на товар.

### Пример 4: Таблица студентов с датой регистрации

| Столбец          | Тип данных    | Описание                                   |
|------------------|---------------|--------------------------------------------|
| student_id       | INT           | Уникальный идентификатор студента (первичный ключ) |
| first_name       | VARCHAR(50)   | Имя студента                              |
| last_name        | VARCHAR(50)   | Фамилия студента                          |
| registration_date| DATETIME      | Дата и время регистрации                  |
| course_id        | INT           | Идентификатор курса, на который записан студент (внешний ключ) |

**Комментарий**: В этой таблице внешний ключ `course_id` ссылается на таблицу курсов (которая не показана здесь). Это создает связь между студентами и курсами.

### Пример 5: Таблица транзакций

| Столбец          | Тип данных     | Описание                                   |
|------------------|----------------|--------------------------------------------|
| transaction_id   | BIGINT         | Уникальный идентификатор транзакции (первичный ключ) |
| user_id          | INT            | Идентификатор пользователя, связанный с транзакцией (внешний ключ) |
| transaction_date | DATETIME       | Дата и время транзакции                    |
| amount           | DECIMAL(10,2)  | Сумма транзакции                           |
| transaction_type | VARCHAR(20)    | Тип транзакции (например, "депозит", "вывод") |

**Комментарий**: Таблица транзакций отображает финансовые операции. Здесь внешний ключ `user_id` ссылается на таблицу пользователей.

### Пример 6: Таблица сотрудников с должностями

| Столбец          | Тип данных    | Описание                                   |
|------------------|---------------|--------------------------------------------|
| employee_id      | INT           | Уникальный идентификатор сотрудника (первичный ключ) |
| name             | VARCHAR(100)  | Имя сотрудника                             |
| position         | VARCHAR(100)  | Должность сотрудника                       |
| hire_date        | DATE          | Дата найма                                |
| department_id    | INT           | Идентификатор отдела (внешний ключ)        |

**Комментарий**: В этой таблице внешний ключ `department_id` ссылается на таблицу отделов, обеспечивая связь сотрудников с их подразделениями.

## Полезные ссылки:
- [Документация MySQL по CREATE TABLE](https://dev.mysql.com/doc/refman/8.0/en/create-table.html)
- [Документация PostgreSQL по CREATE TABLE](https://www.postgresql.org/docs/current/sql-createtable.html)
- [Типы данных в SQL](https://www.sqltutorial.org/sql-data-types/)
- [Руководство по ключам в SQL](https://www.geeksforgeeks.org/sql-constraints/)
